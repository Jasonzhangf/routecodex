{
  "id": "sample_1c79fa8997aeeb48",
  "timestamp": "2026-01-16T02:04:12.342Z",
  "errorType": "invalid_change_sequence",
  "originalArgs": "{\"changes\":[{\"kind\":\"delete_file\",\"file\":\"apps/backend-service/src/routes/cards.ts\"},{\"kind\":\"create_file\",\"file\":\"apps/backend-service/src/routes/cards.ts\",\"lines\":[\"import { Router } from 'express';\",\"import { CardEntityManager } from '@novelmobile/card-engine';\",\"import { MemoryStorageAdapter } from '@novelmobile/data-access';\",\"\",\"import { createBatchRouter } from './cards-batch.js';\",\"import { createCRUDRouter } from './cards-crud.js';\",\"import { createRelatedRouter } from './cards-related.js';\",\"import { createSearchRouter } from './cards-search.js';\",\"import { createTimelineRouter } from './cards-timeline.js';\",\"\",\"let managerPromise: Promise<CardEntityManager> | null = null;\",\"\",\"async function getManager(): Promise<CardEntityManager> {\",\"  if (!managerPromise) {\",\"    managerPromise = (async () => {\",\"      const storage = new MemoryStorageAdapter();\",\"      await storage.connect();\",\"      return new CardEntityManager(storage, {\",\"        enableVersioning: true,\",\"        enableValidation: false,\",\"      });\",\"    })();\",\"  }\",\"  return managerPromise;\",\"}\",\"\",\"export const cardsRouter = Router();\",\"\",\"cardsRouter.use((req, _res, next) => {\",\"  req.setTimeout?.(5000);\",\"  next();\",\"});\",\"\",\"// Order matters: mount more specific routes first.\",\"cardsRouter.use('/search', createSearchRouter(getManager));\",\"cardsRouter.use('/batch', createBatchRouter(getManager));\",\"\",\"// Dynamic `:id` routes\",\"cardsRouter.use('/:id/related', createRelatedRouter(getManager));\",\"cardsRouter.use('/:id/timeline', createTimelineRouter(getManager));\",\"\",\"// CRUD and misc (includes /:id and /:id/references)\",\"cardsRouter.use('/', createCRUDRouter(getManager));\"]}]}",
  "normalizedArgs": "{\"changes\":[{\"kind\":\"delete_file\",\"file\":\"apps/backend-service/src/routes/cards.ts\"},{\"kind\":\"create_file\",\"file\":\"apps/backend-service/src/routes/cards.ts\",\"lines\":[\"import { Router } from 'express';\",\"import { CardEntityManager } from '@novelmobile/card-engine';\",\"import { MemoryStorageAdapter } from '@novelmobile/data-access';\",\"\",\"import { createBatchRouter } from './cards-batch.js';\",\"import { createCRUDRouter } from './cards-crud.js';\",\"import { createRelatedRouter } from './cards-related.js';\",\"import { createSearchRouter } from './cards-search.js';\",\"import { createTimelineRouter } from './cards-timeline.js';\",\"\",\"let managerPromise: Promise<CardEntityManager> | null = null;\",\"\",\"async function getManager(): Promise<CardEntityManager> {\",\"  if (!managerPromise) {\",\"    managerPromise = (async () => {\",\"      const storage = new MemoryStorageAdapter();\",\"      await storage.connect();\",\"      return new CardEntityManager(storage, {\",\"        enableVersioning: true,\",\"        enableValidation: false,\",\"      });\",\"    })();\",\"  }\",\"  return managerPromise;\",\"}\",\"\",\"export const cardsRouter = Router();\",\"\",\"cardsRouter.use((req, _res, next) => {\",\"  req.setTimeout?.(5000);\",\"  next();\",\"});\",\"\",\"// Order matters: mount more specific routes first.\",\"cardsRouter.use('/search', createSearchRouter(getManager));\",\"cardsRouter.use('/batch', createBatchRouter(getManager));\",\"\",\"// Dynamic `:id` routes\",\"cardsRouter.use('/:id/related', createRelatedRouter(getManager));\",\"cardsRouter.use('/:id/timeline', createTimelineRouter(getManager));\",\"\",\"// CRUD and misc (includes /:id and /:id/references)\",\"cardsRouter.use('/', createCRUDRouter(getManager));\"]}]}",
  "validationError": "invalid_change_sequence",
  "source": "tool-registry.validateToolCall"
}