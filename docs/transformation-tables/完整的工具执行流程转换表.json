{
  "sourceProvider": "Anthropic",
  "targetProvider": "OpenAI",
  "description": "完整的工具执行流程转换表",
  "version": "1.0",
  "focus": "工具执行生命周期和结果处理",

  "toolExecutionLifecycle": {
    "detection": {
      "source": {
        "condition": "LLM decides to use tool",
        "response": {
          "type": "tool_use",
          "id": "string",
          "name": "string",
          "input": "object"
        }
      },
      "target": {
        "condition": "LLM decides to use tool",
        "response": {
          "tool_calls": [
            {
              "id": "string",
              "type": "function",
              "function": {
                "name": "string",
                "arguments": "string"
              }
            }
          ]
        }
      }
    },

    "execution": {
      "clientAction": "客户端执行工具",
      "resultFormat": {
        "anthropic": {
          "role": "user",
          "content": [
            {
              "type": "tool_result",
              "tool_use_id": "string",
              "content": "工具执行结果"
            }
          ]
        },
        "openai": {
          "role": "tool",
          "tool_call_id": "string",
          "content": "工具执行结果"
        }
      }
    },

    "continuation": {
      "process": "客户端将工具结果发送回LLM",
      "expectation": "LLM基于工具结果生成最终响应"
    }
  },

  "finishReasonMappings": {
    "anthropicToOpenai": {
      "end_turn": {
        "source": "end_turn",
        "target": "stop",
        "description": "正常结束，模型完成响应"
      },
      "stop_sequence": {
        "source": "stop_sequence", 
        "target": "stop",
        "description": "遇到停止序列"
      },
      "max_tokens": {
        "source": "max_tokens",
        "target": "length",
        "description": "达到最大token限制"
      },
      "tool_use": {
        "source": "tool_use",
        "target": "tool_calls",
        "description": "需要调用工具"
      }
    },
    "openaiToAnthropic": {
      "stop": {
        "source": "stop",
        "target": "end_turn",
        "description": "正常结束"
      },
      "length": {
        "source": "length", 
        "target": "max_tokens",
        "description": "达到最大token限制"
      },
      "tool_calls": {
        "source": "tool_calls",
        "target": "tool_use",
        "description": "需要调用工具"
      },
      "content_filter": {
        "source": "content_filter",
        "target": "end_turn",
        "description": "内容过滤，Anthropic无直接对应"
      }
    }
  },

  "toolResultFormatMappings": {
    "anthropicToolResult": {
      "format": {
        "type": "tool_result",
        "tool_use_id": "string",
        "content": "string|object|array"
      },
      "placement": {
        "role": "user",
        "content": "[tool_result_object]"
      },
      "example": {
        "role": "user",
        "content": [
          {
            "type": "tool_result",
            "tool_use_id": "msg_123",
            "content": "工具执行成功，返回了结果"
          }
        ]
      }
    },

    "openaiToolResult": {
      "format": {
        "role": "tool",
        "tool_call_id": "string",
        "content": "string|object|array"
      },
      "placement": {
        "role": "tool",
        "content": "工具执行结果"
      },
      "example": {
        "role": "tool",
        "tool_call_id": "call_123",
        "content": "工具执行成功，返回了结果"
      }
    }
  },

  "completeConversationFlow": {
    "anthropicFlow": [
      {
        "step": 1,
        "role": "user",
        "content": "用户输入"
      },
      {
        "step": 2,
        "role": "assistant",
        "content": [
          {
            "type": "text",
            "text": "我需要调用工具来帮助您"
          },
          {
            "type": "tool_use",
            "id": "msg_123",
            "name": "analyzeImage",
            "input": {"imageId": ["1"]}
          }
        ],
        "stop_reason": "tool_use"
      },
      {
        "step": 3,
        "role": "user",
        "content": [
          {
            "type": "tool_result", 
            "tool_use_id": "msg_123",
            "content": "图像分析结果"
          }
        ]
      },
      {
        "step": 4,
        "role": "assistant",
        "content": [
          {
            "type": "text",
            "text": "基于工具结果的最终回答"
          }
        ],
        "stop_reason": "end_turn"
      }
    ],

    "openaiFlow": [
      {
        "step": 1,
        "role": "user",
        "content": "用户输入"
      },
      {
        "step": 2,
        "role": "assistant",
        "content": "我需要调用工具来帮助您",
        "tool_calls": [
          {
            "id": "call_123",
            "type": "function",
            "function": {
              "name": "analyzeImage",
              "arguments": "{\"imageId\": [\"1\"]}"
            }
          }
        ],
        "finish_reason": "tool_calls"
      },
      {
        "step": 3,
        "role": "tool",
        "tool_call_id": "call_123",
        "content": "工具执行结果"
      },
      {
        "step": 4,
        "role": "assistant",
        "content": "基于工具结果的最终回答",
        "finish_reason": "stop"
      }
    ]
  },

  "responseStateMappings": {
    "toolCallRequired": {
      "anthropic": {
        "stop_reason": "tool_use",
        "content": "包含tool_use类型的内容块"
      },
      "openai": {
        "finish_reason": "tool_calls",
        "content": "包含tool_calls数组"
      }
    },
    "conversationComplete": {
      "anthropic": {
        "stop_reason": "end_turn",
        "content": "纯文本响应"
      },
      "openai": {
        "finish_reason": "stop",
        "content": "纯文本响应"
      }
    },
    "lengthLimit": {
      "anthropic": {
        "stop_reason": "max_tokens",
        "content": "截断的响应"
      },
      "openai": {
        "finish_reason": "length",
        "content": "截断的响应"
      }
    }
  },

  "errorHandling": {
    "toolExecutionError": {
      "anthropic": {
        "type": "tool_result",
        "tool_use_id": "string",
        "content": "错误信息",
        "is_error": true
      },
      "openai": {
        "role": "tool",
        "tool_call_id": "string",
        "content": "错误信息",
        "is_error": true
      }
    },
    "toolTimeout": {
      "anthropic": {
        "type": "tool_result",
        "tool_use_id": "string",
        "content": "工具执行超时",
        "is_error": true
      },
      "openai": {
        "role": "tool",
        "tool_call_id": "string",
        "content": "工具执行超时",
        "is_error": true
      }
    }
  }
}